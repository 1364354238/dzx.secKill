# 并发问题

> Redis的API是原子性的操作，但多个命令组合起来并不具备原子性。


## 问题1：超抢

> 同一个用户只能抢购一件相同商品，但在高并发的情况下，可能会出错。


### 解决方法

> 添加唯一索引，绑定订单中的userId和goodsId


## 问题2：超卖

> Redis存储库存数量，多个用户对它进行查，改操作，在高并发情况下该产生超卖问题


### 解决方法

1. list存库存个数字，通过pop操作判断库存是否为空
2. decrement
3. 分布式锁，lua脚本



